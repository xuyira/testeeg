# 生成器参数快速参考

## 📋 三个核心参数

### `--gen_D` (频率粒度)
```
作用: 控制保留哪些频率成分
范围: 2, 4, 8, 16, 32 (必须是2的幂)

D=4  → 保留高频细节 → 生成结果很接近原始
D=8  → 保留主要结构 → 平衡 ⭐推荐
D=16 → 只保留轮廓 → 生成更自由
```

### `--gen_scale` (引导强度)
```
作用: 控制频率引导的力度
范围: 0.1 - 10.0

scale=0.5  → 轻轻引导 → 多样性高
scale=1.0  → 标准引导 → 平衡 ⭐推荐
scale=2.0  → 强力引导 → 保真度高
scale=5.0  → 极强引导 → 几乎复制
```

### `--gen_N` (起始时间步)
```
作用: 从哪个时间步开始应用ILVR
范围: None, 或 0-1000 的整数

N=None → 全程引导(1000→0) → 最强约束 ⭐推荐
N=800  → 早期开始(800→0)  → 强约束
N=500  → 中期开始(500→0)  → 中等约束
N=50   → 仅后期(50→0)     → 弱约束
```

---

## 🎯 推荐配置

### 场景 1: 保守起点（推荐）
```bash
--gen_D 8 --gen_scale 1.0 --gen_N None
```
- 适用于：首次尝试
- 预期：稳定的性能提升

### 场景 2: 强引导（追求高保真）
```bash
--gen_D 4 --gen_scale 2.0 --gen_N None
```
- 适用于：希望生成数据很接近原始数据
- 预期：更高的相关性，可能牺牲一些多样性

### 场景 3: 中期引导（平衡）
```bash
--gen_D 8 --gen_scale 1.5 --gen_N 500
```
- 适用于：平衡保真度和多样性
- 预期：较好的泛化能力

### 场景 4: 弱引导（最大多样性）
```bash
--gen_D 16 --gen_scale 0.5 --gen_N 200
```
- 适用于：需要更多数据变化
- 预期：数据增强效果最强

---

## 🔬 系统性测试

### 测试 D 参数
```bash
for D in 4 8 16; do
    python ... --gen_D $D --gen_scale 1.0 --gen_N None
done
```

### 测试 scale 参数
```bash
for scale in 0.5 1.0 2.0 5.0; do
    python ... --gen_D 8 --gen_scale $scale --gen_N None
done
```

### 测试 N 参数
```bash
for N in None 800 500 200 50; do
    python ... --gen_D 8 --gen_scale 1.0 --gen_N $N
done
```

---

## 📊 参数影响对比

| 配置 | 生成质量 | 多样性 | 训练增益 | 推荐度 |
|------|---------|--------|---------|--------|
| D=4, s=3.0, N=None | 🟢🟢🟢🟢🟢 | 🔴🔴 | 低 | ⭐⭐ |
| D=8, s=1.0, N=None | 🟢🟢🟢🟢 | 🟢🟢🟢 | 中 | ⭐⭐⭐⭐⭐ |
| D=8, s=1.0, N=500 | 🟢🟢🟢 | 🟢🟢🟢🟢 | 中 | ⭐⭐⭐⭐ |
| D=16, s=0.5, N=200 | 🟢🟢 | 🟢🟢🟢🟢🟢 | 高 | ⭐⭐⭐ |

---

## 💡 调优建议

### 如果分类准确率没提升：
```bash
# 尝试更强的引导
--gen_D 4 --gen_scale 2.0 --gen_N None
```

### 如果模型过拟合：
```bash
# 尝试更弱的引导（增加多样性）
--gen_D 16 --gen_scale 0.5 --gen_N 200
```

### 如果训练太慢：
```bash
# 考虑不使用生成器，或只在部分数据上使用
# 或者使用更简单的参数
--gen_D 8 --gen_scale 0.5 --gen_N 500
```

---

## 🚀 快速命令模板

### 复制并修改以下命令：

```bash
# 基础命令
python model_adapt/eeg-conformer/conformer_with_generator.py \
  --test_subject 1 \
  --use_generator \
  --generator_model eeg_adapt/logs/ema_0.9999_010000.pt \
  --gen_D 8 \
  --gen_scale 1.0 \
  --gen_N None \
  --gpus 0

# 根据需要修改：
# --gen_D: 4, 8, 16
# --gen_scale: 0.5, 1.0, 2.0, 5.0
# --gen_N: None, 800, 500, 200, 50
```

---

## ❓ 常见问题

### Q: 三个参数哪个最重要？
**A:** 
1. **gen_D** - 最基础，决定保留哪些频率
2. **gen_scale** - 最灵活，可以精细调节
3. **gen_N** - 可选，大部分情况保持 None

### Q: 推荐的调优顺序？
**A:**
1. 先固定 `D=8, scale=1.0, N=None` 作为基线
2. 然后调节 **scale** (0.5, 1.0, 2.0)
3. 最后调节 **D** (4, 8, 16)
4. 如果还需要，再试 **N** (800, 500)

### Q: 为什么我的设置效果不好？
**A:**
- 如果相关性太低 → 增大 scale 或减小 D
- 如果过拟合 → 减小 scale 或增大 D
- 如果生成太慢 → 尝试设置 N=500 或 N=200

---

## 📝 总结

- **`--gen_D`**: 频率粒度（推荐: 8）
- **`--gen_scale`**: 引导强度（推荐: 1.0）
- **`--gen_N`**: 起始时间步（推荐: None）

**从这里开始：**
```bash
--gen_D 8 --gen_scale 1.0 --gen_N None
```

然后根据实验结果调整！🚀

